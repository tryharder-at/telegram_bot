Функциональные детали:

Система предназначена для широкого круга пользователей, кому нужно получить информацию о выбранном городе.

Пользователю доступны следующие функции:

**/** start – команда начала общения с ботом, присылает сообщение о возможностях бота и как с ним общаться.

**/** guide  – запуск функции по поиску информации в интересующем пользователя городе. Позволяет пользователю:

1) **Указать город** : позволяет пользователю задать требуемый город, для дальнейшего поиска интересных мест или прогноза погоды.

2) **Выбрать сферу интересов из предложенного списка** : Развлечения, Питание, Спорт, Религия, Туризм, Культура, Магазины, Автосервис, Медтовары, Медицина, Животные, Прогулка, Погода.

В результате пользователю отобразиться карта с отмеченным на ней местом, которое принадлежит к указанной им сфере интересов. Место выбирается случайным образом.

При выборе пользователем варианта Погода: отображается информация о погоде в выбранном городе.

**/traffic\_congestion** –позволяет пользователю получить информацию о пробках по введённому пользователем адресу или маршруту (адрес начальной и конечной точки)

**/** stop – завершение работы диалога

таблица состояний сценария

|   | **До диалога** | **После /start** | **После /guide** | **После town** | **После interests** | **После change\_places** | **После /stop** |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **/start** | Активна | — | — | — | — |   | — |
| **/guide** | — | Активна |   |   |   |   | Активна |
| **town** | — | — | Активна | — | — | Активна | — |
| **interests** | — | — | — | Активна | Активна | — | — |
| **change\_places** | — | — | — | — | Активна | — |   |
| **/stop** | — | — | Активна | Активна | Активна | Активна | — |
| **/traffic\_congestion** | — | Активна | — | — | — |   | Активна |

Структура проекта

Приложение будет содержать 4 модуля:

- main
- geocoder
- weather\_api
- settings

Модуль Main содержит следующие функции:

**main** - главная функция программы- бота должна:

1. Создать объект Updater, передав ему токен, полученный от @BotFather. Это объект, получающий на вход сообщения от telegram-сервера. Задача этого объекта — организация сетевого взаимодействия между клиентом и сервером.
2. Получить от Updater&#39;а Dispatcher. Диспетчер отвечает за вызов обработчиков сообщений. Он перенаправляет сообщения внутри программы
3. Получить функции-обработчики для сообщений и команд и зарегистрировать их в диспетчере.
4. Диспетчер хранит обработчики сообщений — handler&#39;ы. Это функции, имеющие определенную сигнатуру, получающие на вход сообщения уже определенных типов с информацией о том, от каких пользователей пришли данные сообщения.
5. Запустить цикл приема и обработки сообщений. Внутри Updater&#39;а реализован цикл приема-передачи сообщений, который запускается в отдельном потоке специальным вызовом.
6. Дожидаться окончания/прерывания работы программы.

**start** - приветствие пользователя, вывод документации по работе с ботом

**guide** –начало диалога с пользователем

**town** – определение города

**interests** – смена города, вывод текущей погоды, результат поиска по организациям/топонимам

**change** \_ **places** –смена города

**stop** – прекращение поиска

**traffic** \_ **congestion** – вывод карты с состоянием автомобильного движения в городе

Модуль geocoder –содержит функции для работы с API Яндекс.Карт

**geocode** – обработка запроса

**get** \_ **coordinates** – получение координат объекта по его адресу

**get** \_ **ll** \_ **span** – получение параметров объекта для рисования карты вокруг него

**search** – нахождение организаций в городе

Модуль weather\_ap –содержит функции для работы с API Яндекс.Погоды

get\_weather – получение данных по прогнозу погоды

План выполнения

Этапы разработки

| № п/п | Задача | Участник | Оценка продолжительности исполнения |
| --- | --- | --- | --- |
| 1 | Регистрация бота |
| 2 | Получение ключей от API |
| 3 | Создание главной функции (main) |
| 4 | Обработчик команды start |
| 5 | Разработка модуля geocoder |
| 6 |
 
